# Breakfast split1 cam01 — test inference + segmentation config
checkpoint_path: "/home/johnny/action_ws/checkpoints/motion_tokenizer/epochs10_breakfast_split1_webcam02_m10/best.pt"
decoder_window_size: 320

device: "cuda"
amp: true
visualize: false
show_overlay: false
window_title: "MotionTokenizer Stream"
display_fps: 10

input:
  type: "folder"
  dir: "/home/johnny/action_ws/online_datasets/breakfast/breakfast/Videos_test.split1_webcam02"
  video_exts: [".avi"]
  recursive: true
  batch:
    size: 1
  eof_timeout_seconds: 5

target_fps: 10
resize_shorter: 320
stride: 4

# Optional: stream codes (disabled by default)
jsonl_output: false
jsonl_path: "/home/johnny/action_ws/output/breakfast/segments_split1_webcam02/stream_codes.jsonl"

energy:
  enable: true
  source: "quantized"            # prequant | quantized | velocity
  mode: "token_diff_l2_mean"     # l2_mean | token_diff_l2_mean
  visualize: false
  jsonl_output: true
  # 将能量 JSONL 输出到与分割相同的根目录，便于评估脚本读取
  jsonl_path: "/home/johnny/action_ws/output/breakfast/segments_split1_webcam02"
  smoothing:
    enable: false

segmentation:
  enable: true
  mode: "report"                 # 从阈值报告读取阈值
  # 报告文件与键名与 tools/threshold_search_with_gt.py 的动态键保持一致
  report_path: "/home/johnny/action_ws/output/breakfast/thresholds/split1_webcam02/best_threshold_quantized_token_diff.json"
  report_key: "quantized_token_diff_l2_mean_best.best_f1.thr"
  output_dir: "/home/johnny/action_ws/output/breakfast/segments_split1_webcam02"
  export_segments_json: true
  hysteresis_ratio: 0.95
  up_count: 2
  down_count: 2
  cooldown_windows: 1
  max_duration_seconds: 2.0

