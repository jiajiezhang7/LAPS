# HDBSCAN 密度聚类评估

- 数据源聚合: attn_norm，度量: cosine
- 网格搜索: min_cluster_size=[60, 80, 100, 120], min_samples=[3, 5, 8, 10, 15]
- 结果 CSV: ./umap_vis/statistics/cluster_metrics_hdbscan_grid.csv
- 最佳可视化: ./umap_vis/figure/umap_2d_hdbscan_best.png, ./umap_vis/figure/umap_3d_hdbscan_best.html

## 表格1：HDBSCAN 网格（口径A - 仅核心点，按 Silhouette 降序）

| min_cluster_size | min_samples | sil_core | db_core | ch_core | intra/inter_core | noise_ratio | n_clusters |
|---:|---:|---:|---:|---:|---:|---:|---:|
| 100 | 8 | 0.673 | 0.678 | 2297.6 | 0.151 | 0.631 | 4 |
| 80 | 5 | 0.640 | 0.712 | 2358.9 | 0.174 | 0.566 | 4 |
| 100 | 5 | 0.640 | 0.712 | 2358.9 | 0.174 | 0.566 | 4 |
| 120 | 5 | 0.640 | 0.712 | 2358.9 | 0.174 | 0.566 | 4 |
| 100 | 3 | 0.583 | 0.766 | 2170.4 | 0.175 | 0.532 | 4 |
| 120 | 3 | 0.583 | 0.766 | 2170.4 | 0.175 | 0.532 | 4 |
| 80 | 3 | 0.558 | 0.741 | 1749.9 | 0.165 | 0.516 | 5 |
| 60 | 5 | 0.506 | 0.752 | 1863.3 | 0.164 | 0.555 | 5 |
| 60 | 3 | 0.495 | 0.728 | 1603.7 | 0.151 | 0.533 | 6 |
| 60 | 15 | 0.190 | 1.148 | 472.7 | 0.280 | 0.448 | 2 |

## 表格2：调优后最佳 HDBSCAN vs KMeans(k=5)

| 方法 | Silhouette | DB | CH | Intra/Inter | 簇数量 | 噪声比例 |
|---|---:|---:|---:|---:|---:|---:|
| KMeans 基线 | 0.490 | 1.063 | 3064.8 | 0.260 | 5 | 0.000 |
| HDBSCAN 核心(调优后) | 0.190 | 1.148 | 472.7 | 0.280 | 2 | 0.448 |
| HDBSCAN 映射(调优后) | 0.209 | 2.170 | 941.7 | 0.406 | 2 | 0.000 |

## 参数调优后（降噪优先策略）

### 调优前 vs 调优后（核心优先 vs 降噪优先）

| 配置 | 噪声比例 | Sil_core | Intra/Inter_core | Sil_all | mcs | ms |
|---|---:|---:|---:|---:|---:|---:|
| 调优前最佳(核心优先) | 0.658 | 0.715 | 0.136 | 0.458 | 120 | 40 |
| 调优后最佳(降噪优先) | 0.448 | 0.190 | 0.280 | 0.209 | 60 | 15 |

### 目标达成判定

- 噪声比例≤0.10: 未达成（当前 0.448）
- 口径A Silhouette≥0.60: 未达成（当前 0.190）
- 口径A Intra/Inter≤0.20: 未达成（当前 0.280）
- 口径B Silhouette≥0.49: 未达成（当前 0.209）

> 注：口径A为核心点，仅在 labels!=-1 子集上计算；口径B将噪声映射到最近质心后在全样本上计算。
