# Inference configuration for AMPLIFY Motion Tokenizer
# 专用于短视频片段的离线推理（Latent Action Sequences 导出）

# 模型权重与主配置
checkpoint_dir: "/home/johnny/johnny_ws/motion_tokenizer/checkpoints/train_20250917_172407"
checkpoint_name: "best.pth"
model_config: "./amplify_motion_tokenizer/configs/tokenizer_config.yaml"

# 输入与输出
video_root: "/media/johnny/Data/data_motion_tokenizer/short_videos_inference/"
output_dir: "./amplify_motion_tokenizer/inference_outputs"

# 采样与窗口
# 注意：target_fps 应与训练时一致（论文与本项目默认使用 20Hz）。
# 视频原始frame rate = 25, 动作片段 50帧，重采样后剩余33帧，因此stride=8的话，只剩下3个窗口
target_fps: 20
resize_shorter: 480
# 由于 T=16, 那么stride = 16 可以保证窗口无重叠
stride: 16  # 论文建议训练数据生成时 stride=1
video_exts: [".mp4", ".mov", ".avi", ".mkv"]

# 设备
device: "auto"  # auto / cuda / cpu

# 其他
max_files: 0  # 0 或负数表示不限制
save_codes: true  # 若 FSQ 返回离散 codes，则一并保存
save_json: true         # 保存 JSON（见下方导出模式）
json_export_mode: "both"   # 导出模式：codes | matrix | both
save_jsonl: true        # 追加写入聚合 JSONL（每行一个片段的 codes 二维数组）
jsonl_filename: "codes.jsonl"
debug_fsq: true
